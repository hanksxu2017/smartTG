<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap SYSTEM "./mapsql.dtd">
<sqlMap>

    <!-- 这里面只支持SQL语句，不支持HQL语句的执行-->
    
    <!-- SQL语句-->
    <!-- 菜单列表树 -->
    <sqlUnit name="select_study_school_list">
        <sql>
           select t.id, t.name, t.address, t.create_time from tg_study_school t order by t.create_time asc
        </sql>
    </sqlUnit>

    <sqlUnit name="select_study_teacher_list">
        <sql>
            select t.id, t.name, t.phone, t.level, t.create_time from tg_study_teacher t order by t.create_time asc
        </sql>
    </sqlUnit>
    <!-- 教师简单列表 -->
    <sqlUnit name="teacher_simp_list">
        <sql>
            select t.id, t.name, t.level from tg_study_teacher t
            [ where t.name like '%:name%']
            order by t.create_time asc
        </sql>
    </sqlUnit>

    <sqlUnit name="select_study_classroom_list">
        <sql>
            select t.id, t.study_school_name, t.name, t.description, t.create_time from tg_study_classroom t
            order by t.create_time asc
        </sql>
    </sqlUnit>

    <sqlUnit name="select_study_class_list">
        <sql>
            select t.id, t.name, t.teacher_name, t.level, t.description, t.create_time from tg_study_class t
            order by t.create_time asc
        </sql>
    </sqlUnit>

    <!-- 学生 -->
    <sqlUnit name="select_study_student_list">
        <sql>
            select t.id, t.name, if(t.sex = 1, "男生", "女生"), t.birthday, t.school_name, t.parent_name, t.parent_phone,
            t.level,
            CASE t.status WHEN "NORMAL" THEN '正常'
            WHEN "DROP_OUT" THEN '退学'
            WHEN "TEMP_LEAVE" THEN "休学"
            ELSE '未定义' END ,
            t.remain_course, t.create_time
            from tg_study_student t
            order by t.create_time asc
        </sql>
    </sqlUnit>
    <!-- 学生简单列表 -->
    <sqlUnit name="student_simp_list">
        <sql>
            select t.id, t.name, t.level, t.remain_course, date_format(t.create_time, '%Y-%c-%d')
            from tg_study_student t
            where t.status = 'NORMAL'
            [ and t.name like '%:name%']
            order by t.create_time asc
        </sql>
    </sqlUnit>


    <!-- 班级 -->
    <sqlUnit name="select_study_course_list">
        <sql>
            select t.id, t.week_info, t.course_time, t.class_name, t.classroom_name, t.teacher_name, t.status, t.description, t.create_time
            from tg_study_course t
            order by t.create_time asc
        </sql>
    </sqlUnit>
    <!-- 教师的课时信息 -->
    <sqlUnit name="teacher_course_list">
        <sql>
            select t.id, t.name,
            CASE t.week_info WHEN "7" THEN '星期天'
            ELSE CONCAT('星期', t.week_info) END,
            t.course_time, t.classroom_name,
            CASE t.status WHEN "NORMAL" THEN '正常'
            ELSE '未定义' END,
            t.create_time, t.description
            from tg_study_course t
            where t.teacher_id =:id
            order by t.create_time asc
        </sql>
    </sqlUnit>
    <sqlUnit name="teacher_course_weeks">
        <sql>
            select DISTINCT T.week_info
            from tg_study_course t
            where t.teacher_id =:teacherId
            order by t.create_time asc
        </sql>
    </sqlUnit>
    <!-- 学生已选的课时信息 -->
    <sqlUnit name="student_course_list">
        <sql>
            select t.id, t.name,
            CASE t.week_info WHEN "7" THEN '星期天'
            ELSE CONCAT('星期', t.week_info) END,
            t.course_time, t.classroom_name, t.teacher_name,
            CASE t.status WHEN "NORMAL" THEN '正常'
            ELSE '未定义' END,
            t.create_time, t.description
            from tg_study_course t, tg_study_student_course_rel rel
            where rel.student_id =:id and rel.course_id = t.id
            order by t.create_time asc
        </sql>
    </sqlUnit>

    <sqlUnit name="select_study_class_rel_list">
        <sql>
            select t.id, t.student_name, t.class_name, t.teacher_name, t.status, t.create_time
            from tg_study_student_class_rel t
            order by t.create_time asc
        </sql>
    </sqlUnit>

    <sqlUnit name="select_study_course_rel_list">
        <sql>
            select t.id, t.course_week_info, t.course_time, t.student_name,t.class_name, t.classroom_name, t.teacher_name, t.status, t.create_time
            from tg_study_student_course_rel t
            order by t.create_time asc
        </sql>
    </sqlUnit>

    <sqlUnit name="select_study_course_record_list">
        <sql>
            select t.id, t.course_date, t.course_time, t.class_name, t.classroom_name,
            t.teacher_name, t.student_quantity_plan, t.student_quantity_actual, t.student_personal_leave,
            t.student_other_absent,
            t.status, t.create_time, t.description
            from tg_study_course_record t
            order by t.create_time asc
        </sql>
    </sqlUnit>

    <sqlUnit name="select_study_course_student_record_list">
        <sql>
            select t.id, sr.student_name, t.course_date, t.course_time, t.class_name, t.classroom_name, t.teacher_name,
            CASE sr.status WHEN "NORMAL" THEN '正常'
            ELSE '未定义' END ,
            sr.description, sr.update_time
            from tg_study_course_record t, tg_study_course_student_record sr
            where t.id = sr.course_rec_id
            order by t.create_time asc
        </sql>
    </sqlUnit>



</sqlMap>